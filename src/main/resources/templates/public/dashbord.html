<!doctype html>
<html th:with="tabTitle='dashbord'" lang="fr">

<head th:replace="~{_fragments/layout :: head(${tabTitle})}">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../static/css/styles.css" />
</head>

<body>

  <!-- -->
  <!-- En-tête de page - barre de navigation -->
  <!-- -->
  <header th:replace="~{_fragments/layout :: header }"></header>

  <!-- -->
  <!-- Contenu de la page -->
  <!-- -->

  <!DOCTYPE html>
  <html lang="fr">

  <head>
    <meta charset="UTF-8">
    <title>Dashboard - Gestion de l'événement</title>
    <script>
      function afficherBouton(id) {
        document.getElementById(id).classList.add('visible');
      }

      function filterTable(inputId, tableId) {
        const input = document.getElementById(inputId);
        const filter = input.value.toLowerCase();
        const table = document.getElementById(tableId);
        const tr = table.getElementsByTagName("tr");

        for (let i = 1; i < tr.length; i++) {
          const tds = tr[i].getElementsByTagName("td");
          let visible = false;
          for (let j = 0; j < tds.length; j++) {
            if (tds[j].textContent.toLowerCase().indexOf(filter) > -1) {
              visible = true;
              break;
            }
          }
          tr[i].style.display = visible ? "" : "none";
        }
      }

      function sortTable(tableId, colIndex) {
        const table = document.getElementById(tableId);
        const rows = Array.from(table.rows).slice(1);
        const asc = table.getAttribute("data-sort-dir") !== "asc";

        rows.sort((a, b) => {
          const cellA = a.cells[colIndex].innerText.toLowerCase();
          const cellB = b.cells[colIndex].innerText.toLowerCase();
          return asc ? cellA.localeCompare(cellB) : cellB.localeCompare(cellA);
        });

        rows.forEach(row => table.appendChild(row));
        table.setAttribute("data-sort-dir", asc ? "asc" : "desc");
      }
    </script>
  </head>

  <body>

    <h1>Dashboard - Gestion de l'événement</h1>

    <!-- Section BÉNÉVOLES -->
    <h2>Gestion des bénévoles</h2>
    <input type="text" id="searchBenevoles" onkeyup="filterTable('searchBenevoles', 'tableBenevoles')"
      placeholder="Rechercher un bénévole...">
    <table id="tableBenevoles">
      <tr>
        <th onclick="sortTable('tableBenevoles', 0)">Nom</th>
        <th onclick="sortTable('tableBenevoles', 1)">Email</th>
        <th onclick="sortTable('tableBenevoles', 2)">Poste</th>
        <th>Tâche à effectuer</th>
        <th>Note du jour</th>
        <th>Action</th>
      </tr>
      <tr>
        <td>Jean Dupont</td>
        <td>jean@mail.com</td>
        <td>
          <select onchange="afficherBouton('btn1')">
            <option>Bipeur</option>
            <option>Contrôleur</option>
            <option>Gardien</option>
          </select>
        </td>
        <td><input type="text" placeholder="Attribuer une tâche" oninput="afficherBouton('btn1')"></td>
        <td><input type="number" min="1" max="5" onchange="afficherBouton('btn1')"></td>
        <td><button id="btn1">Mettre à jour</button></td>
      </tr>
      <tr>
        <td>Claire Martin</td>
        <td>claire@mail.com</td>
        <td>
          <select onchange="afficherBouton('btn2')">
            <option>Bipeur</option>
            <option>Contrôleur</option>
            <option>Gardien</option>
          </select>
        </td>
        <td><input type="text" placeholder="Attribuer une tâche" oninput="afficherBouton('btn2')"></td>
        <td><input type="number" min="1" max="5" onchange="afficherBouton('btn2')"></td>
        <td><button id="btn2" class="">Mettre à jour</button></td>
      </tr>
    </table>
    <!-- Section PARTICIPANTS -->
    <h2>Gestion des participants</h2>
    <input type="text" id="searchParticipants" onkeyup="filterTable('searchParticipants', 'tableParticipants')"
      placeholder="Rechercher un participant...">
    <table id="tableParticipants">
      <tr>
        <th onclick="sortTable('tableParticipants', 0)">Nom</th>
        <th onclick="sortTable('tableParticipants', 1)">Email</th>
        <th onclick="sortTable('tableParticipants', 2)">Événement</th>
        <th>État d'inscription</th>
        <th>Action</th>
      </tr>
      <tr>
        <td>Sophie Durand</td>
        <td>sophie@mail.com</td>
        <td>Canoë Jeune</td>
        <td>
          <select onchange="afficherBouton('btn3')">
            <option>En cours</option>
            <option>Validé</option>
            <option>Refusé</option>
          </select>
        </td>
        <td><button id="btn3">Mettre à jour</button></td>
      </tr>
      <tr>
        <td>Antoine Leblanc</td>
        <td>antoine@mail.com</td>
        <td>Slalom Régional</td>
        <td>
          <select onchange="afficherBouton('btn4')">
            <option>En cours</option>
            <option>Validé</option>
            <option>Refusé</option>
          </select>
        </td>
        <td><button id="btn4">Mettre à jour</button></td>
      </tr>
    </table>

  </body>

  </html>


  <!-- Fin Contenu de la page -->

  <!-- -->
  <!-- Pied de page -->
  <!-- -->
  <footer th:replace="~{_fragments/layout :: footer}"> </footer>

  <!-- Scripts définis dans le layout -->
  <th:block th:replace="~{_fragments/layout :: bottom-scripts}"></th:block>

</body>

</html>